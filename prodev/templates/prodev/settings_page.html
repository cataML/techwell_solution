{% extends "base_prodev.html" %}
{% load static %}
{% block title %}Prodev | Dashboard{% endblock %}
{%  block content %}

<aside class="sidebar">
    <h2 class="logo">DevPanel</h2>
    <ul>
        <li><a href="{% url 'prodev:overview' %}"><i class="fa fa-home"></i> Overview</a></li>
        <li><a href="{% url 'prodev:dev_messages' %}"><i class="fa fa-comments"></i> Messages</a></li>
        <li><a href="{% url 'prodev:analytics' %}"><i class="fa fa-chart-line"></i> Analytics</a></li>
        <li><a href="{% url 'prodev:settings_page' %}"><i class="fa fa-cog"></i> Settings</a></li>
    </ul>
</aside>
<div class="settings-container">
    <h1>Settings</h1>

    {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <p class="message">{{ message }}</p>
            {% endfor %}
        </div>
    {% endif %}

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <h2>Profile Information</h2>
        <div class="setting-item">
            <label>First Name</label>
            <input type="text" name="first_name" value="{{ user.first_name }}">
        </div>

        <div class="setting-item">
            <label>Last Name</label>
            <input type="text" name="last_name" value="{{ user.last_name }}">
        </div>

        <div class="setting-item">
            <label>Email</label>
            <input type="email" name="email" value="{{ user.email }}">
        </div>

        <div class="setting-item">
            <label>Password <small>(leave blank to keep current)</small></label>
            <input type="password" name="password">
        </div>

        <div class="setting-item">
            <label>Profile Picture</label>
            {% if settings.profile_picture %}
                <img src="{{ settings.profile_picture.url }}" class="profile-img" alt="Profile Picture">
            {% endif %}
            <input type="file" name="profile_picture">
        </div>

        <h2>Preferences</h2>
        <div class="setting-item">
            <label>
                <input type="checkbox" name="email_notifications" {% if settings.email_notifications %}checked{% endif %}>
                Email Notifications
            </label>
        </div>

        <div class="setting-item">
            <label>
                <input type="checkbox" id="darkModeToggle" name="dark_mode" {% if settings.dark_mode %}checked{% endif %}>
                Dark Mode
            </label>
        </div>

        <div class="setting-item">
            <label for="profile_visibility">Profile Visibility</label>
            <select name="profile_visibility" id="profile_visibility">
                <option value="public" {% if settings.profile_visibility == "public" %}selected{% endif %}>Public</option>
                <option value="private" {% if settings.profile_visibility == "private" %}selected{% endif %}>Private</option>
            </select>
        </div>

        <button type="submit">Save Settings</button>
    </form>
</div>

<script>
    // Instant Dark Mode Toggle
    const darkToggle = document.getElementById('darkModeToggle');
    const body = document.body;

    function updateDarkMode() {
        if(darkToggle.checked){
            body.style.backgroundColor = '#1e1e2f';
            body.style.color = '#eee';
        } else {
            body.style.backgroundColor = '#f4f6f8';
            body.style.color = '#333';
        }
    }

    // Initial load
    updateDarkMode();

    darkToggle.addEventListener('change', updateDarkMode);
</script>
{% endblock %}